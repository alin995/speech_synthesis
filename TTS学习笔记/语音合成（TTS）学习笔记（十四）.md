# 语音合成学习（十四）学习笔记

---
## UMAP概述

一种强大的非线性降维算法

 许多数据都是高维的，难以直观地理解和分析。UMAP（Uniform Manifold Approximation and Projection）是一种非线性降维算法，被广泛应用于数据可视化、推荐系统、自然语言处理、图像处理和基因组学等领域。UMAP通过将高维数据映射到低维空间中，帮助我们发现数据的结构、关联和相似性。

UMAP 是一种基于流形学习技术和拓扑数据分析思想的降维算法。它为处理流形学习和降维提供了一个非常通用的框架，但也可以提供具体的具体实现。

> 该算法基于对数据的三个假设:
>
> 数据均匀分布在黎曼流形上;
> 黎曼度量是局部常数 (或可以近似) ;
> 歧管是本地连接的。

根据这些假设，可以用模糊拓扑结构对流形进行建模。通过搜索具有最接近的等效模糊拓扑结构的数据的低维投影来找到嵌入。
UMAP提高了速度并更好地保存了数据的全局结构。UMAP 的核心使用图形布局算法在低维空间中排列数据。

在最简单的意义上，UMAP 构建数据的高维图表示，然后优化低维图以使其在结构上尽可能相似。
为了构建初始的高维图，UMAP 构建了一个叫做“模糊单纯复形”的东西。这实际上只是加权图的表示，边权重表示两个点连接的可能性。为了确定连通性，UMAP 从每个点向外扩展一个半径，当这些半径重叠时连接点。选择这个半径很关键一一选择太小会导致小而孤立的集群，而选择太大会将所有东西连接在一起。UMAP 通过根据到每个点n的距离在本地选择半径来克服这一挑战 最近的邻居。UMAP 然后通过随看半径的增长避低连接的口 能件采使图模动"。最后，通讨规定每个点必须至少连接到 其最近的邻居。UMAP 确保后部结构与全局结构保持平衡。

---

### UMAP如何工作的？

> **UMAP的工作原理：**
> <u>UMAP的工作原理基于流形学习的思想，它通过保持数据点之间的局部关系来进行降维。UMAP使用了两个关键的步骤：构建邻近图和优化过程。</u>

- Projection ——通过投影点在平面、曲面或线上再现空间对象的过程或技术。也可以将其视为对象从高维空间到低维空间的映射。

- Approximation——算法假设我们只有一组有限的数据样本（点），而不是构成流形的整个集合。因此，我们需要根据可用数据来近似流形。

- Manifold——流形是一个拓扑空间，在每个点附近局部类似于欧几里得空间。一维流形包括线和圆，但不包括类似数字8的形状。二维流形（又名曲面）包括平面、球体、环面等。

- Uniform——均匀性假设告诉我们我们的数据样本均匀（均匀）分布在流形上。但是，在现实世界中，这种情况很少发生。因此这个假设引出了在流形上距离是变化的概念。即，空间本身是扭曲的：空间根据数据显得更稀疏或更密集的位置进行拉伸或收缩。

综上所述，我们可以将UMAP描述为:

一种降维技术，假设可用数据样本均匀（Uniform）分布在拓扑空间（Manifold）中，可以从这些有限数据样本中近似（Approximation）并映射（Projection）到低维空间。



### **UMAP执行的步骤**

·构建邻近图：首先，UMAP计算数据点之间的距离，并根据距离选择邻近的数据点。然后，它构建一个邻近图，其中每个数据点都与其邻近点相连。邻近图可以是k-最近邻图或基于距离的邻近图。

·优化过程：UMAP使用随机梯度下降算法来优化降维过程。它通过最小化数据点之间的距离差异来保持数据点之间的局部关系。UMAP使用了两个损失函数：局部连通性损失和全局结构损失。局部连通性损失保持了数据点在低维空间中的邻近关系，而全局结构损失保持了整体的数据结构。

·降维映射：最后，UMAP将优化后的低维表示映射到二维或三维空间中，以便进行可视化和分析。UMAP使用了t-SNE算法来进行最终的映射，以保持数据点之间的相对距离。



---

UMAP的使用：

```python
import umap
from sklearn.datasets import load_digits
digits = load_digits()
embedding = umap.UMAP(n_neighbors=5,
	min_dist=0.3,
	metric='correlation').fit_transform(digits.data)
umap.plot.points(mapper, labels=digits.target)
```

UMAP可以设置的主要参数如下：

两个最常用的参数：n_neighbors 和 min_dist，它们有效地用于控制最终降维结果中局部和全局结构之间的平衡。

最重要的参数是n_neighbors，用于构造初始高维图的近似最近邻的数量。它有效地控制UMAP如何平衡局部结构与全局结构 ：较小的值将通过限制在分析高维数据时考虑的相邻点的数量来推动UMAP更多地关注局部结构，而较大的值将推动UMAP代表全局结构，丢失详细的局部结构。一般来说，这个参数应该经常在 5 到 50 的范围内，选择 10 到 15 是一个合理的默认值。

我们将研究的第二个参数是 min_dist，即低维空间中点之间的最小距离，紧密程度。此参数控制UMAP将点聚集在一起的紧密程度，较低的值会导致嵌入更紧密，更准确地针对局部结构进行优化。较大的 min_dist值将使UMAP将点更松散地打包在一起，确保嵌入点分布更均匀，而是专注于保留广泛的拓扑结构。合理的值在 0.001 到 0.5 的范围内，0.1 是合理的默认值。

下面的可视化，探索了UMAP参数对 3D 数据的 2D 投影的影响。通过更改 n_neighbors和min_dist参数，您可以探索它们对生成投影的影响。
<img align="center" src="/img/UMAP.png"/>

metric：这决定了用于测量输入空间中距离的度量的选择。已经编码了各种各样的度量标准，并且可以传递用户定义的函数，只要它已经通过 numba 进行了 JITd。

---

##  UMAP常见的应用领域：

**数据可视化**

> UMAP可以将高维数据降维到二维或三维空间中，以便进行可视化和理解。它可以帮助发现数据中的聚类、类别和结构，并揭示数据之间的相似性和差异性。

**推荐系统**

> UMAP可以用于构建推荐系统，通过将用户和物品的特征表示映射到低维空间中，来发现用户和物品之间的关联关系。这可以用于个性化推荐、相似物品推荐等。

**自然语言处理**

> UMAP可以用于将文本数据映射到低维空间中，以便进行文本聚类、文本分类和文本相似性计算等任务。它可以帮助发现文本之间的语义相似性和语义关系, 帮助我们理解和分析文本数据。

**图像处理**

> UMAP可以用于将图像特征映射到低维空间中，以便进行图像聚类、图像分类和图像检索等任务。它可以帮助发现图像之间的视觉相似性和视觉关系。

**基因组学**

> UMAP可以用于分析基因表达数据，帮助发现基因表达的模式和结构，以及基因之间的关联关系。它可以用于基因表达聚类、基因表达分类和基因表达差异分析等。

总之，UMAP是一种强大的降维算法，可以在许多不同的领域和应用中发挥作用，帮助发现数据的结构、关联和相似性。

通过将高维数据映射到低维空间中，UMAP帮助我们发现数据的结构、关联和相似性，从而提供了更深入的洞察和理解。随着数据的不断增长和复杂性的提高，UMAP将继续在各个领域中发挥着重要的作用。

---
**本文主要介绍了UMAP的概述，UMAP如何工作，UMAP执行步骤，以及 常见的应用领域。**

---

## 相关资源

> [参考文章](https://huaweicloud.csdn.net/63807f80dacf622b8df8903c.html?spm=1001.2101.3001.6650.6&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~activity-6-121302082-blog-124400062.235^v38^pc_relevant_anti_t3&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~activity-6-121302082-blog-124400062.235^v38^pc_relevant_anti_t3&utm_relevant_index=10)
>
> **Github地址**：[vocab-coverage](https://github.com/twang2218/vocab-coverage)

